SQL> 
SQL> --Test data for task 2.1
SQL> 
SQL> --test entry of a working payment
SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.insert_new_payment_procedure(100,500,'FIRST PAYMENT',:var_message);

PL/SQL procedure successfully completed.

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
order balance remaining: 500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> 
SQL> --test entry of a working payment; order_balance reaches 0 and order is complete
SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.insert_new_payment_procedure(100,500,'SECOND PAYMENT',:var_message);

PL/SQL procedure successfully completed.

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
Order Completed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

SQL> 
SQL> --test entry of a null payment
SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.insert_new_payment_procedure(100,500,'FIRST PAYMENT',:var_message);

Error starting at line : 27 in command -
BEGIN mdru_manage_package.insert_new_payment_procedure(100,500,'FIRST PAYMENT',:var_message); END;
Error report -
ORA-20001: Invalid Order - invalid payment.
ORA-06512: at "DSAM0003.MDRU_MANAGE_PACKAGE", line 84
ORA-06512: at line 1

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
SQL> 
SQL> 
SQL> --Test data for task 2.2 
SQL> 
SQL> --ALTER TABLE COMMAND
SQL> 
SQL> ALTER TABLE loan ADD (
  2      loan_return_date   DATE
  3  );

Error starting at line : 36 in command -
ALTER TABLE loan ADD (
    loan_return_date   DATE
)
Error report -
ORA-01430: column being added already exists in table
01430. 00000 -  "column being added already exists in table"
*Cause:    
*Action:
SQL> 
SQL> SELECT
  2      drone_id,
  3      drone_on_loan_count
  4  FROM
  5      drone;

  DRONE_ID DRONE_ON_LOAN_COUNT
---------- -------------------
       100                   0
       101                   0
       102                   2
       103                   1
       104                   0
       105                   2
       106                   2
       107                   1
       108                   3

9 rows selected. 

SQL> 
SQL> --test entry for valid loan_return 
SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.manage_loan(100,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message);

Error starting at line : 50 in command -
BEGIN mdru_manage_package.manage_loan(100,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message); END;
Error report -
ORA-20001: INVALID RETURN DATE.
ORA-06512: at "DSAM0003.MDRU_MANAGE_PACKAGE", line 186
ORA-06512: at line 1

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
SQL> 
SQL> SELECT
  2      drone_id,
  3      drone_on_loan_count
  4  FROM
  5      drone;

  DRONE_ID DRONE_ON_LOAN_COUNT
---------- -------------------
       100                   0
       101                   0
       102                   2
       103                   1
       104                   0
       105                   2
       106                   2
       107                   1
       108                   3

9 rows selected. 

SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.manage_loan(102,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message);

Error starting at line : 62 in command -
BEGIN mdru_manage_package.manage_loan(102,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message); END;
Error report -
ORA-20001: INVALID RETURN DATE.
ORA-06512: at "DSAM0003.MDRU_MANAGE_PACKAGE", line 186
ORA-06512: at line 1

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
SQL> 
SQL> SELECT
  2      drone_id,
  3      drone_on_loan_count
  4  FROM
  5      drone;

  DRONE_ID DRONE_ON_LOAN_COUNT
---------- -------------------
       100                   0
       101                   0
       102                   2
       103                   1
       104                   0
       105                   2
       106                   2
       107                   1
       108                   3

9 rows selected. 

SQL> 
SQL> --test entry for invalid loan_return 
SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.manage_loan(106,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message);

Error starting at line : 76 in command -
BEGIN mdru_manage_package.manage_loan(106,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message); END;
Error report -
ORA-20001: INVALID RETURN DATE.
ORA-06512: at "DSAM0003.MDRU_MANAGE_PACKAGE", line 186
ORA-06512: at line 1

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
SQL> 
SQL> --test entry for invalid loan_return (loan has already been returned)
SQL> 
SQL> VAR var_message CHAR
SQL> 
SQL> EXEC mdru_manage_package.manage_loan(100,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message);

Error starting at line : 84 in command -
BEGIN mdru_manage_package.manage_loan(100,TO_DATE('19/DEC/18 12:00:00','DD/MON/RR HH24:MI:SS'),:var_message); END;
Error report -
ORA-20001: LOAN ALREADY RETURNED.
ORA-06512: at "DSAM0003.MDRU_MANAGE_PACKAGE", line 184
ORA-06512: at line 1

SQL> 
SQL> PRINT var_message

VAR_MESSAGE
--------------------------------------------------------------------------------
SQL> 
SQL> 
SQL> --Test data for task 2.3
SQL> 
SQL> --Get all details out for customer 109.
SQL> 
SQL> VAR cus_details_rows refcursor;
SQL> 
SQL> EXEC mdru_manage_package.customer_drone_details(109,:cus_details_rows);

PL/SQL procedure successfully completed.

SQL> 
SQL> PRINT cus_details_rows


  DRONE_ID PLATFORM                                                RANGE MANUFACTURE_DAT R D D SUPPLIER_ID RETURN_DATE             
---------- -------------------------------------------------- ---------- --------------- - - - ----------- ------------------------
       102 Navig8 Electric                                            20 20-AUG-18       N Y Y         101 19/DEC/18 12:00:00      
       103 IA-17 Manta                                                20 06-DEC-17       N Y Y         100 19/DEC/18 12:00:00      


SQL> 
SQL> --Get all details out for customer 102.
SQL> VAR cus_details_rows refcursor;
SQL> 
SQL> EXEC mdru_manage_package.customer_drone_details(102,:cus_details_rows);

PL/SQL procedure successfully completed.

SQL> 
SQL> PRINT cus_details_rows


  DRONE_ID PLATFORM                                                RANGE MANUFACTURE_DAT R D D SUPPLIER_ID RETURN_DATE             
---------- -------------------------------------------------- ---------- --------------- - - - ----------- ------------------------
       105 GuardianEye                                                 4 30-OCT-17       N Y N         101 19/DEC/18 12:00:00      
       106 Global Hawk (RQ-4)                                      22780 30-OCT-17       N Y N         104 19/DEC/18 12:00:00      
       107 Hunter                                                     30 10-FEB-19       N Y N         109 19/DEC/18 12:00:00      
       108 Fire Scout (MQ-8C)                                        250 15-MAR-19       N Y N         108                         
       108 Fire Scout (MQ-8C)                                        250 15-MAR-19       N Y N         108 19/DEC/18 12:00:00      


SQL> 
SQL> SPOOL off;
